<!DOCTYPE html>
<html lang="en">
<head>
      <!-- Filepond stylesheet -->
    <link href="https://unpkg.com/filepond/dist/filepond.css" rel="stylesheet">
    <link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet">

    <meta charset="UTF-8">
    <title>Web</title>
    <style>
        .left {
            float: left;
            width: 50%;
            height: auto;
        }
        .right {
            float: right;
            width: 50%;
            height: auto;
        }
    </style>
    <script>
        function op_unwrap_n_replace() {
            console.log("op_unwrap_n_replace")
        }
    </script>
</head>
<body>
    <h1>Hello World!</h1>
    <!-- We'll transform this input into a pond -->
    <input type="file" class="filepond">

    <!-- Load FilePond library -->
    <script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>
    <script src="https://unpkg.com/filepond/dist/filepond.js"></script>

    <!-- Turn all file input elements into ponds -->
        <script>
            var inputElement = document.querySelector('input[type="file"]');
            FilePond.registerPlugin(FilePondPluginImagePreview);
            FilePond.setOptions({
                // 设置单个URL是定义服务器配置的最基本形式。
                server: {
                    url: '/upload_img',
                    process: {
                    //处理图片上传接口的返回内容
                    onload: function(response) {
                      var resp = JSON.parse(response);
                      console.log("resp:", resp.filename);
                      if (document.getElementById('server_upload_filename_left').innerText.trim() != 'null') {
                          document.getElementById('server_upload_filename_right').innerText = resp.filename;
                          document.getElementById('img_right')
                      }
                      else
                          document.getElementById('server_upload_filename_left').innerText = resp.filename;
                    }
                  }
                },
                // 设置图片类型只能为png才能上传
                allowFileTypeValidation: true,
                acceptedFileTypes: "image/png",
                // 启用或禁用图像裁剪
                allowImageCrop: true,

                // 启用或禁用文件大小验证
                allowFileSizeValidation: true,
                maxFileSize: null,

                // 启用或禁用提取EXIF信息
                allowImageExifOrientation: true

            });
            FilePond.create(inputElement)
        </script>

    <div class="left">
        <p>图1</p>
        <p id="server_upload_filename_left">null</p>
         <img id="img_right" src=""/>
    </div>

    <div class="right">
        <p>图2</p>
        <p id="server_upload_filename_right">null</p>
         <img id="img_right" src=""/>
        <button onclick="op_unwrap_n_replace()">颜色处理</button>
    </div>
</body>
</html>
